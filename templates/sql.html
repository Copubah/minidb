{% extends "base.html" %}
{% block title %}SQL Console{% endblock %}

{% block content %}
<div class="card">
    <h2 style="margin-bottom: 20px;">SQL Console</h2>
    <p style="color: #6b7280; margin-bottom: 15px;">
        Execute SQL queries directly against MiniDB. Try: <code>SELECT * FROM tasks</code>
    </p>
    
    <form method="POST">
        <textarea id="sql" name="sql" rows="4" placeholder="Enter SQL query..." style="font-family: monospace;">{{ sql }}</textarea>
        <button type="submit" class="btn btn-primary">Execute</button>
    </form>
</div>

{% if error %}
<div class="card" style="border-left: 4px solid #dc2626;">
    <h3 style="color: #dc2626;">Error</h3>
    <pre style="background: #fef2f2; color: #991b1b; margin-top: 10px;">{{ error }}</pre>
</div>
{% endif %}

{% if result %}
<div class="card">
    <h3 style="margin-bottom: 15px;">Result</h3>
    
    {% if result.message %}
        <p style="color: #16a34a;">{{ result.message }}</p>
    {% elif result.rows %}
        <div style="overflow-x: auto;">
            <table>
                <thead>
                    <tr>
                        {% for col in result.columns %}
                        <th>{{ col }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in result.rows %}
                    <tr>
                        {% for col in result.columns %}
                        <td>{{ row[col] if row[col] is not none else 'NULL' }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <p style="color: #6b7280; margin-top: 10px;">({{ result.rows|length }} rows)</p>
    {% else %}
        <p style="color: #6b7280;">Empty result set</p>
    {% endif %}
</div>
{% endif %}

<div class="card">
    <h3 style="margin-bottom: 10px;">Quick Reference</h3>
    <pre>-- Create table
CREATE TABLE name (col TYPE [PRIMARY KEY|UNIQUE|NOT NULL], ...)

-- Insert data
INSERT INTO table (cols) VALUES (vals)

-- Query data
SELECT * FROM table WHERE col = value ORDER BY col LIMIT n

-- Update data
UPDATE table SET col = value WHERE condition

-- Delete data
DELETE FROM table WHERE condition

-- Join tables
SELECT * FROM t1 JOIN t2 ON t1.col = t2.col

-- Types: INTEGER, TEXT, FLOAT, BOOLEAN</pre>
</div>
{% endblock %}
